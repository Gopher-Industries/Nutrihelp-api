# General Security Plugin

This plugin (`general_security`) detects common, generic security issues across a codebase.

## What it detects

- Hardcoded secrets
  - Looks for variable-like keys (e.g. `password`, `secret`, `api_key`, `token`, `jwt_secret`) assigned string values.
  - Requires value length >= 8 to reduce incidental matches.
- Hardcoded database connection strings
  - Matches `postgres://` and `mysql://` style URLs in code/config files.
- Permissive CORS configurations
  - Detects `Access-Control-Allow-Origin: *` or `origin: '*'` patterns.

## Configuration

The plugin reads configuration from the scanner's plugin config and supports the following keys:

- `enabled` (bool): Enable or disable this plugin.
- `allowlist_keys` (list[str]): Keys to ignore when scanning for secrets (case-insensitive).
- `exclude_paths` (list[str]): Path substrings; if any matches a file path, that file will be skipped by this plugin.
- `secret_keys_allowlist` (list[str]): Additional secret key names to match.

Example config snippet (in scanner config):

```yaml
plugins:
  general_security:
    enabled: true
    allowlist_keys:
      - 'TEST_SECRET'
    exclude_paths:
      - 'migrations/'
      - 'tests/'
    secret_keys_allowlist:
      - 'password'
      - 'jwt'
```

## False positives and mitigation

- The plugin uses heuristics and simple regexes; add known safe keys to `allowlist_keys` and common test/dev paths to `exclude_paths`.
- If you see many false positives from a specific pattern, prefer to add an allowlist entry or refine your scanner config.

## Extending

This plugin is intentionally lightweight. To add more checks:
- Implement additional regex or AST-based checks in `scan()`.
- Use `self.add_finding(...)` to add structured findings (recommendation can be a dict for richer rendering).

## Output

Findings are returned as `SecurityFinding` objects (converted to dict by the engine) with fields:
- `title`, `severity`, `file_path`, `line_number`, `description`, `plugin_name`, `recommendation`

These are rendered in the HTML/JSON reports by the shared renderer.
